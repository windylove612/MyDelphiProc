unit fmProcJMJS;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, RzLabel, RzBckgnd, ExtCtrls, RzPanel, Mask, RzEdit,
  RzCmboBx, RzButton, RzBorder,math;

type
  TfmJMJS = class(TForm)
    RzPanel3: TRzPanel;
    RzPanel4: TRzPanel;
    RzLabel42: TRzLabel;
    RzLabel43: TRzLabel;
    RzLabel44: TRzLabel;
    RzLabel45: TRzLabel;
    RzLabel46: TRzLabel;
    RzLabel47: TRzLabel;
    RzLabel48: TRzLabel;
    RzLabel49: TRzLabel;
    RzLabel50: TRzLabel;
    RzLabel51: TRzLabel;
    RzLabel52: TRzLabel;
    RzLabel53: TRzLabel;
    RzLabel54: TRzLabel;
    RzLabel55: TRzLabel;
    RzLabel56: TRzLabel;
    RzLabel57: TRzLabel;
    RzLabel58: TRzLabel;
    RzLabel59: TRzLabel;
    RzLabel60: TRzLabel;
    RzEdit31: TRzEdit;
    RzEdit32: TRzEdit;
    RzEdit33: TRzEdit;
    RzEdit34: TRzEdit;
    RzEdit35: TRzEdit;
    RzEdit36: TRzEdit;
    RzEdit37: TRzEdit;
    RzEdit38: TRzEdit;
    RzEdit39: TRzEdit;
    RzEdit40: TRzEdit;
    comNL: TRzComboBox;
    RzSeparator2: TRzSeparator;
    RzPanel5: TRzPanel;
    RzLabel61: TRzLabel;
    RzLabel62: TRzLabel;
    RzLabel63: TRzLabel;
    RzLabel64: TRzLabel;
    RzLabel65: TRzLabel;
    RzLabel66: TRzLabel;
    RzLabel67: TRzLabel;
    RzLabel68: TRzLabel;
    RzLabel69: TRzLabel;
    RzLabel70: TRzLabel;
    RzLabel71: TRzLabel;
    RzLabel72: TRzLabel;
    RzLabel73: TRzLabel;
    RzLabel74: TRzLabel;
    RzLabel75: TRzLabel;
    RzLabel76: TRzLabel;
    RzLabel77: TRzLabel;
    RzLabel78: TRzLabel;
    RzLabel79: TRzLabel;
    RzLabel80: TRzLabel;
    RzLabel81: TRzLabel;
    RzLabel82: TRzLabel;
    RzEdit43: TRzEdit;
    RzEdit44: TRzEdit;
    RzEdit50: TRzEdit;
    RzEdit51: TRzEdit;
    RzEdit52: TRzEdit;
    RzEdit53: TRzEdit;
    RzEdit54: TRzEdit;
    RzEdit55: TRzEdit;
    RzEdit56: TRzEdit;
    RzEdit57: TRzEdit;
    RzEdit58: TRzEdit;
    RzEdit59: TRzEdit;
    RzEdit60: TRzEdit;
    RzSeparator1: TRzSeparator;
    RzPanel1: TRzPanel;
    RzButton1: TRzButton;
    RzButton2: TRzButton;
    RzLabel1: TRzLabel;
    RzLabel2: TRzLabel;
    RzLabel3: TRzLabel;
    RzLabel4: TRzLabel;
    RzLabel5: TRzLabel;
    RzLabel6: TRzLabel;
    RzLabel7: TRzLabel;
    RzLabel8: TRzLabel;
    RzLabel9: TRzLabel;
    RzLabel10: TRzLabel;
    RzLabel11: TRzLabel;
    RzEdit1: TRzEdit;
    RzEdit2: TRzEdit;
    RzEdit3: TRzEdit;
    RzEdit4: TRzEdit;
    RzEdit5: TRzEdit;
    RzEdit6: TRzEdit;
    RzEdit7: TRzEdit;
    RzEdit8: TRzEdit;
    RzEdit9: TRzEdit;
    RzEdit10: TRzEdit;
    RzEdit11: TRzEdit;
    RzLabel12: TRzLabel;
    RzLabel13: TRzLabel;
    RzLabel14: TRzLabel;
    RzLabel15: TRzLabel;
    RzLabel16: TRzLabel;
    RzLabel17: TRzLabel;
    RzLabel18: TRzLabel;
    RzLabel19: TRzLabel;
    RzLabel20: TRzLabel;
    RzLabel21: TRzLabel;
    RzLabel22: TRzLabel;
    RzBorder1: TRzBorder;
    RzBorder2: TRzBorder;
    RzBorder3: TRzBorder;
    RzBorder4: TRzBorder;
    RzLabel23: TRzLabel;
    RzLabel24: TRzLabel;
    RzLabel25: TRzLabel;
    RzLabel26: TRzLabel;
    RzLabel27: TRzLabel;
    RzLabel28: TRzLabel;
    RzLabel29: TRzLabel;
    RzLabel30: TRzLabel;
    RzLabel31: TRzLabel;
    RzLabel32: TRzLabel;
    RzLabel33: TRzLabel;
    RzLabel34: TRzLabel;
    RzLabel35: TRzLabel;
    RzLabel36: TRzLabel;
    RzEdit12: TRzEdit;
    RzEdit13: TRzEdit;
    comSJ: TRzComboBox;
    comZX: TRzComboBox;
    procedure RzButton2Click(Sender: TObject);
    procedure RzButton1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  fmJMJS: TfmJMJS;

implementation

{$R *.dfm}

procedure TfmJMJS.RzButton2Click(Sender: TObject);
var
  i:integer;
begin
  for i:=0 to RzPanel1.ControlCount-1 do
  begin
    if RzPanel1.Controls[i] is TRzEdit then
      TRzEdit(RzPanel1.Controls[i]).Text:='';
  end;
  for i:=0 to RzPanel4.ControlCount-1 do
  begin
    if RzPanel4.Controls[i] is TRzEdit then
      TRzEdit(RzPanel4.Controls[i]).Text:='';
  end;
  for i:=0 to RzPanel5.ControlCount-1 do
  begin
    if RzPanel5.Controls[i] is TRzEdit then
      TRzEdit(RzPanel5.Controls[i]).Text:='';
  end;
end;

procedure TfmJMJS.RzButton1Click(Sender: TObject);
var
  sTNL,sAA,sFAT,sNL,sPTT:double;
begin
  if RzEdit31.Text='' then
  begin
    showmessage('请输入体重!');
    exit;
  end;
  if RzEdit32.Text='' then
  begin
    showmessage('请输入足月儿奶或q2h!');
    exit;
  end;
  if RzEdit33.Text='' then
  begin
    showmessage('请输入全天总液量!');
    exit;
  end;
  if RzEdit34.Text='' then
  begin
    showmessage('请输入PN液量!');
    exit;
  end;
  if RzEdit35.Text='' then
  begin
    showmessage('请输入氨基酸!');
    exit;
  end;
  if RzEdit36.Text='' then
  begin
    showmessage('请输入脂肪乳!');
    exit;
  end;
  if RzEdit37.Text='' then
  begin
    showmessage('请输入PN中钠量!');
    exit;
  end;
  if RzEdit38.Text='' then
  begin
    showmessage('请输入PN中钾量!');
    exit;
  end;
  if RzEdit39.Text='' then
  begin
    showmessage('请输入PN时间!');
    exit;
  end;
  if RzEdit40.Text='' then
  begin
    showmessage('请输入PN糖速!');
    exit;
  end;
  RzEdit7.Color:=clInfoBk;
  RzEdit8.Color:=clInfoBk;
  //氨基酸和脂肪乳
  RzEdit10.Text:=RzEdit35.Text;
  RzEdit11.Text:=RzEdit36.Text;
  //PN液量
  if comSJ.ItemIndex=0 then
    sNL:=roundto(StrToFloat(RzEdit32.text),-2)*12*0.7
  else if comSJ.ItemIndex=1 then
    sNL:=roundto(StrToFloat(RzEdit32.text),-2)*8*0.7;

  RzEdit12.Text:=FloatToStr(roundto(StrToFloat(RzEdit33.text)*StrToFloat(RzEdit31.Text)-sNL-StrToFloat(RzEdit34.text),-2));
  //PN磅速
  RzEdit13.Text:=FloatToStr(roundto(StrToFloat(RzEdit12.text)/StrToFloat(RzEdit39.text),-2));
  //6%aa
  RzEdit54.Text:=FloatToStr(roundto(StrToFloat(RzEdit35.text)*StrToFloat(RzEdit31.Text)/0.06,-2));
  //20%脂肪乳
  RzEdit55.Text:=FloatToStr(roundto(StrToFloat(RzEdit36.text)*StrToFloat(RzEdit31.Text)/0.2,-2));
  //10%氯化钠
  RzEdit56.Text:=FloatToStr(roundto(StrToFloat(RzEdit37.text)*StrToFloat(RzEdit31.Text)/1.7,-2));
  //10%氯化钾
  RzEdit57.Text:=FloatToStr(roundto(StrToFloat(RzEdit38.text)*StrToFloat(RzEdit31.Text)/1.3,-2));
  //葡萄糖液体量
  sPTT:=StrToFloat(RzEdit12.text)-StrToFloat(RzEdit54.text)-StrToFloat(RzEdit55.text)-StrToFloat(RzEdit56.text)-StrToFloat(RzEdit57.text);
  //
  RzEdit50.Text:=FloatToStr(roundto((StrToFloat(RzEdit40.text)*StrToFloat(RzEdit31.Text)*StrToFloat(RzEdit39.Text)*0.6-sPTT)/4,-2));
  //
  RzEdit51.Text:=FloatToStr(roundto(sPTT-StrToFloat(RzEdit50.Text),-2));
  //糖能量
  sTNL:=roundto((StrToFloat(RzEdit50.text)*0.5+StrToFloat(RzEdit51.text)*0.1)*4,-2);
  sAA:=roundto(StrToFloat(RzEdit35.text)*StrToFloat(RzEdit31.text)*4,-2);
  sFAT:=roundto(StrToFloat(RzEdit36.text)*StrToFloat(RzEdit31.text)*9,-2);

  RzEdit1.Text:=FloatToStr(roundto(sTNL/(sTNL+sAA+sFAT),-4)*100);
  //aa能量
  RzEdit2.Text:=FloatToStr(roundto(sAA/(sTNL+sAA+sFAT),-4)*100);
  //FAT能量
  RzEdit3.Text:=FloatToStr(roundto(sFAT/(sTNL+sAA+sFAT),-4)*100);
  //奶能量
  if comNL.ItemIndex=0 then
  begin
    if comSJ.ItemIndex=0 then
      RzEdit4.Text:=FloatToStr(roundto(StrToFloat(RzEdit32.text)*12*0.68,-2))
    else if comSJ.ItemIndex=1 then
      RzEdit4.Text:=FloatToStr(roundto(StrToFloat(RzEdit32.text)*12*0.8,-2));
  end
  else if comNL.ItemIndex=1 then
  begin
    if comSJ.ItemIndex=0 then
      RzEdit4.Text:=FloatToStr(roundto(StrToFloat(RzEdit32.text)*8*0.68,-2))
    else if comSJ.ItemIndex=1 then
      RzEdit4.Text:=FloatToStr(roundto(StrToFloat(RzEdit32.text)*8*0.8,-2));
  end;
  //PN能量
  RzEdit5.Text:=FloatToStr(roundto(sTNL+sAA+sFAT,-2));
  //总能量
  RzEdit6.Text:=FloatToStr(roundto((StrToFloat(RzEdit4.text)+StrToFloat(RzEdit5.text))/StrToFloat(RzEdit31.Text),-2));
  //渗透压
  RzEdit7.Text:=FloatToStr(roundto((StrToFloat(RzEdit51.text)*0.5+StrToFloat(RzEdit50.text)*2.5+StrToFloat(RzEdit54.Text)*0.6+StrToFloat(RzEdit55.Text)*0.3+StrToFloat(RzEdit56.Text)*3.4+StrToFloat(RzEdit57.Text)*2.666)*10,-2));
  //糖浓度
  RzEdit8.Text:=FloatToStr(roundto((StrToFloat(RzEdit50.text)*0.5+StrToFloat(RzEdit51.text)*0.1)/StrToFloat(RzEdit12.Text),-4)*100);
  //氨基酸浓度
  RzEdit9.Text:=FloatToStr(roundto(StrToFloat(RzEdit35.text)*StrToFloat(RzEdit31.text)/StrToFloat(RzEdit12.Text),-4)*100);
  if comZX.ItemIndex=0 then
  begin
    if StrToFloat(RzEdit7.Text)>2000 then
    begin
      RzEdit7.Color:=clRed;
    end;
    if StrToFloat(RzEdit8.Text)>25 then
    begin
      RzEdit8.Color:=clRed;
    end;
  end;
  if comZX.ItemIndex=1 then
  begin
    if StrToFloat(RzEdit7.Text)>850 then
    begin
      RzEdit7.Color:=clRed;
    end;
    if StrToFloat(RzEdit8.Text)>12.5 then
    begin
      RzEdit8.Color:=clRed;
    end;
  end;
end;

procedure TfmJMJS.FormCreate(Sender: TObject);
begin
  RzEdit7.Color:=clInfoBk;
  RzEdit8.Color:=clInfoBk;
end;

end.
